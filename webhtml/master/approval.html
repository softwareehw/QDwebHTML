<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>审批</title>
  <link href="../../css/bootstrap.min.css" rel="stylesheet">
  <link href="../../font-awesome/css/font-awesome.css" rel="stylesheet">
  <link href="../../css/animate.css" rel="stylesheet">
  <link href="../../css/style.css" rel="stylesheet">
  <!-- Mainly scripts -->
  <script src="../../js/jquery-3.1.1.min.js"></script>
  <script src="../../js/popper.min.js"></script>
  <script src="../../js/bootstrap.js"></script>
  <script src="../../js/plugins/metisMenu/jquery.metisMenu.js"></script>
  <script src="../../js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue"></script>
  <!-- Flot -->
  <script src="../../js/plugins/flot/jquery.flot.js"></script>
  <script src="../../js/plugins/flot/jquery.flot.tooltip.min.js"></script>
  <script src="../../js/plugins/flot/jquery.flot.spline.js"></script>
  <script src="../../js/plugins/flot/jquery.flot.resize.js"></script>
  <script src="../../js/plugins/flot/jquery.flot.pie.js"></script>
  <script src="../../js/plugins/flot/jquery.flot.symbol.js"></script>
  <script src="../../js/plugins/flot/jquery.flot.time.js"></script>

  <!-- Peity -->
  <script src="../../js/plugins/peity/jquery.peity.min.js"></script>
  <script src="../../js/demo/peity-demo.js"></script>

  <!-- Custom and plugin javascript -->
  <script src="../../js/inspinia.js"></script>
  <script src="../../js/plugins/pace/pace.min.js"></script>

  <!-- jQuery UI -->
  <script src="../../js/plugins/jquery-ui/jquery-ui.min.js"></script>

  <!-- EayPIE -->
  <script src="../../js/plugins/easypiechart/jquery.easypiechart.js"></script>

  <!-- Sparkline -->
  <script src="../../js/plugins/sparkline/jquery.sparkline.min.js"></script>

  <!-- Sparkline demo data  -->
  <script src="../../js/demo/sparkline-demo.js"></script>
</head>

<body>
<div id="wrapper" class="gray-bg">
  <div id="page-wrapper" class="gray-bg" style="margin: 0;">
    <div class="wrapper wrapper-content">
      <div class="row">
        <!--         <div class="col-lg-3">
                  <div class="ibox ">
                    <div class="ibox-content mailbox-content">
                      <div class="file-manager"> <a class="btn btn-block btn-primary compose-mail" href="../manager/mail_compose.html">Compose</a>
                        <div class="space-25"></div>
                        <h5>Folders</h5>
                        <ul class="folder-list m-b-md" style="padding: 0">
                          <li><a href="../manager/mailbox.html"> <i class="fa fa-inbox "></i> Inbox <span class="label label-warning float-right">16</span> </a></li>
                          <li><a href="../manager/mailbox.html"> <i class="fa fa-envelope-o"></i> Send Mail</a></li>
                          <li><a href="../manager/mailbox.html"> <i class="fa fa-certificate"></i> Important</a></li>
                          <li><a href="../manager/mailbox.html"> <i class="fa fa-file-text-o"></i> Drafts <span class="label label-danger float-right">2</span></a></li>
                          <li><a href="../manager/mailbox.html"> <i class="fa fa-trash-o"></i> Trash</a></li>
                        </ul>
                        <h5>Categories</h5>
                        <ul class="category-list" style="padding: 0">
                          <li><a href="#"> <i class="fa fa-circle text-navy"></i> Work </a></li>
                          <li><a href="#"> <i class="fa fa-circle text-danger"></i> Documents</a></li>
                          <li><a href="#"> <i class="fa fa-circle text-primary"></i> Social</a></li>
                          <li><a href="#"> <i class="fa fa-circle text-info"></i> Advertising</a></li>
                          <li><a href="#"> <i class="fa fa-circle text-warning"></i> Clients</a></li>
                        </ul>
                        <h5 class="tag-title">Labels</h5>
                        <ul class="tag-list" style="padding: 0">
                          <li><a href=""><i class="fa fa-tag"></i> Family</a></li>
                          <li><a href=""><i class="fa fa-tag"></i> Work</a></li>
                          <li><a href=""><i class="fa fa-tag"></i> Home</a></li>
                          <li><a href=""><i class="fa fa-tag"></i> Children</a></li>
                          <li><a href=""><i class="fa fa-tag"></i> Holidays</a></li>
                          <li><a href=""><i class="fa fa-tag"></i> Music</a></li>
                          <li><a href=""><i class="fa fa-tag"></i> Photography</a></li>
                          <li><a href=""><i class="fa fa-tag"></i> Film</a></li>
                        </ul>
                        <div class="clearfix"></div>
                      </div>
                    </div>
                  </div>
                </div> -->
        <div class="col-lg-12">
          <div class="mail-box-header">

            <h2> 部门员工请假申请 </h2>
            <div class="mail-tools tooltip-demo m-t-md">
              <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="left" title="Refresh inbox"><i class="fa fa-refresh"></i> 刷新</button>
              <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="top" title="agree"><i class="fa fa-exclamation"></i> 同意</button>
              <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="top" title="disagree"><i class="fa fa-trash-o"></i> 驳回</button>
            </div>
          </div>

          <div class="mail-box">
            <table class="table table-hover table-mail">
              <tbody>
              <tr class="title">
                <td class="check-mail"></td>
                <td class="mail-ontact">员工姓名</td>
                <td class="mail-ontact">员工编号</td>
                <td class="mail-ontact">开始时间</td>
                <td class="mail-ontact">结束时间</td>
              </tr>

              <tr class="read">
                <td class="check-mail"><input type="checkbox" class="i-checks"></td>
                <td class="mail-ontact"><a href="../manager/mail_detail.html">王鑫雨</a></td>
                <td class="mail-ontact"><a href="../manager/mail_detail.html">126</a></td>
                <td class="mail-ontact"><a href="../manager/mail_detail.html">2019/6/9 上</a></td>
                <td class="mail-ontact"><a href="../manager/mail_detail.html">2019/6/11 上</a></td>
              </tr>

              </tbody>
            </table>
          </div>
        </div>


        <div class="col-lg-12">
          <div class="mail-box-header">

            <h2> 部门员工加班申请 </h2>
            <div class="mail-tools tooltip-demo m-t-md">
              <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="left" title="Refresh inbox"><i class="fa fa-refresh"></i> 刷新</button>
              <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="top" title="agree"><i class="fa fa-exclamation"></i> 同意</button>
              <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="top" title="disagree"><i class="fa fa-trash-o"></i> 驳回</button>
            </div>
          </div>

          <div class="mail-box">
            <table class="table table-hover table-mail">
              <tbody>
              <tr class="title">
                <td class="mail-ontact">申请编号</td>
                <td class="mail-ontact">员工编号</td>
                <td class="mail-ontact">员工姓名</td>
                <td class="mail-ontact">时间</td>
              </tr>

              <tr id="app2" class="read" v-for="EW in EWs">
                <td class="check-mail"><input type="checkbox" class="i-checks">{{EW.applicatedId}}</td>
                <td class="mail-ontact"><a href="../manager/mail_detail.html">{{EW.applicatedPerson}}</a></td>
                <td class="mail-ontact"><a href="../manager/mail_detail.html">{{EW.state}}</a></td>
                <td class="mail-ontact"><a href="../manager/mail_detail.html">{{EW.date}}</a></td>
              </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  //请假部分


  //加班部分
  new Vue({
    el:"#app2",
    data:{
      EWs:[],
      employeeNames:[],
      selected:[],
      num:0
    },
    method:{
    },
    created:function(){
      console.log("ajax beging \n")
      var that = this;
      //var sectorId=localStorage.getItem("sectorId");
      jQuery.ajax({
        type:"GET",
        url:"http://39.105.38.34:8080/api/v1/EWs/uncheck/sectors/123",
        contentType:"application/json",
        xhrFields: {
          withCredentials: true
        },
        crossDomain: true,
        success:function(data) {
          that.EWs = JSON.parse(data);
          that.num = that.EWs.length;
          //根据employeeId获取员工名
          for (i = 0; i < that.num; i++) {
            jQuery.ajax({
              type: "GET",
              url: "http://39.105.38.34:8080/api/v1/employees/" + that.EWs[i].applicatedPerson,
              contentType: "application/json",
              xhrFields: {
                withCredentials: true
              },
              crossDomain: true,
              async: false,
              success: function (result) {
                var tname = JSON.parse(result);
                that.EWs[i]['state']=tname[0].name;
                console.log(i);

              },
              error: function (result) {
                console.log("fail");
              }
            });
          }
        },
        error:function(data){
          console.log("fail");
        }
      });
      //根据employeeId获取员工名
      // for(var i=0;i<num;i++){
      //   jQuery.ajax({
      //     type:"GET",
      //     url:"http://39.105.38.34:8080/api/v1/employees/"+this.EWs[i].applicatedPerson,
      //     contentType:"application/json",
      //     xhrFields: {
      //       withCredentials: true
      //     },
      //     crossDomain: true,
      //     success:function(data){
      //       var t=JSON.parse(data);
      //       that.employeeNames[i]=t[0].name;
      //     },
      //     error:function(data){
      //       console.log("fail");
      //     }
      //   });
    }

  })

</script>

</body>
</html>
